---
title: "Summary for the stimuli selection experiment"
output: html_notebook
---
- Last checked: `r format(Sys.Date(), "%d-%b-%Y")`

# Descriptive Stats for the generated stimuli

**Participants:** Anna, Thomas and me

**Experiment brief overview:**

- Participants were asked to listen to a number of recordings and required to rate to what extent articulation/dynamics was implemented. They rated for each expression (articulation, dynamics).
- We used a 5-point likert scale for rating.
- 64 stimuli, consisting of 16 high (both articulation and dynamics implemented), 16 articulation-only (only articulation implemented), 16 dynamics-only (only dynamics implemented) and 16 low (none of them implemented).

**Technical things:**

- The stimuli were presented randomly for each participant.
- The order of rating (articulation first or dynamics first) was randomised within participants, but the half of the ratings started with articulation and the other half started with 
- There were 3 practice trials.

**Goal:**

- Pick 4 performances which represent the characteristics of each category the most.

**Issues:**

- How to select? Need stats?

```{r setup, include = FALSE}
# install packages
if (!require("data.table")) {install.packages("data.table"); require("data.table")}
if (!require("ggplot2")) {install.packages("ggplot2"); require("ggplot2")}

# setting
theme_update(legend.position = "bottom")
```

## Overall rating for each category
- Art_only (articulation only)
- Dyn_only (dynamics only)
- High (articulation + dynamics)
- Low (none)

```{r raw, echo = FALSE}
# Create a list of data file names
lf <- list.files(".", pattern = "csv")

# Create raw_data - merge all data files into one
raw_data <- data.table()
for (i in 1:length(lf)){
  data_i <- fread(file.path(".", lf[i]), header = T, sep = ",", dec = ".")
  raw_data <- rbind(raw_data, data_i)
}
# remove unnecessary strings from midFile
raw_data$midFile <- gsub("./practice/", "", raw_data$midFile)
raw_data$midFile <- gsub("./mid/", "", raw_data$midFile)
raw_data$midFile <- gsub(".mid", "", raw_data$midFile)

# remove practice trials
data <- raw_data[expMode == "experiment"]
```

```{r summary, echo = FALSE}
data$stimCategory <- "NA"
data[startsWith(midFile, "high") == TRUE]$stimCategory <- "High"
data[startsWith(midFile, "art") == TRUE]$stimCategory <- "Art_only"
data[startsWith(midFile, "dyn") == TRUE]$stimCategory <- "Dyn_only"
data[startsWith(midFile, "low") == TRUE]$stimCategory <- "Low"

# overall rating for each category
summary_data <- data[, .(N = .N/2, meanRating = mean(rating), SD = sd(rating), SEM = sd(rating)/sqrt(.N/2)), by = .(stimCategory, ratingCategory)]
summary_data[order(ratingCategory, stimCategory)]
```

## Plot
- Error bars represent SEM.
```{r summary_plot, echo = FALSE}
plot <- ggplot(summary_data, aes(x = stimCategory, y = meanRating)) +
  geom_bar(stat = 'identity') +
  geom_errorbar(aes(ymin = meanRating-SEM, ymax = meanRating + SEM), width=.2,
                 position=position_dodge(.9)) +
  facet_wrap(ratingCategory ~ .)
plot
```
**Comments**

It seems participants can easily detect articulation but not dynamics.

## For each performance
### High performance
```{r high, echo = ALSE}
data_high <- data[stimCategory == "High", .(N = .N, rating = rating), by = .(subjectNumber, ratingCategory, midFile)]

# organise data.table
data_high$subjectNumber <- factor(data_high$subjectNumber)
data_high$Rating <- factor(data_high$rating)
data_high$midFile <- gsub("high_", "", data_high$midFile)

# plot
p_high <- ggplot(data_high, aes(x = midFile, y = rating, colour = subjectNumber, group = subjectNumber)) +
  geom_point(aes(shape = subjectNumber), position = position_dodge(width = .5)) +
  facet_wrap((ratingCategory ~ .))
p_high
```

### Articulation-only performance
```{r art, echo = FALSE}
data_art <- data[stimCategory == "Art_only", .(N = .N, rating = rating), by = .(subjectNumber, ratingCategory, midFile)]

# organise data.table
data_art$subjectNumber <- factor(data_art$subjectNumber)
data_art$Rating <- factor(data_art$rating)
data_art$midFile <- gsub("art_", "", data_art$midFile)

# plot
p_art <- ggplot(data = data_art, aes(x = midFile, y = rating, colour = subjectNumber, group = subjectNumber)) +
  geom_point(aes(shape = subjectNumber), position = position_dodge(width = .5)) +
  facet_wrap((ratingCategory ~ .)) +
  ylim(1, 5)
p_art
```

### Dynamics-only performance
```{r dyn, echo = FALSE}
data_dyn <- data[stimCategory == "Dyn_only", .(N = .N, rating = rating), by = .(subjectNumber, ratingCategory, midFile)]

# organise data.table
data_dyn$subjectNumber <- factor(data_dyn$subjectNumber)
data_dyn$Rating <- factor(data_dyn$rating)
data_dyn$midFile <- gsub("dyn_", "", data_dyn$midFile)

# plot
p_dyn <- ggplot(data = data_dyn, aes(x = midFile, y = rating, colour = subjectNumber, group = subjectNumber)) +
  geom_point(aes(shape = subjectNumber), position = position_dodge(width = .5)) +
  facet_wrap((ratingCategory ~ .)) +
  ylim(1, 5)
p_dyn
```
### Low performance
```{r low, echo = FALSE}
data_low <- data[stimCategory == "Low", .(N = .N, rating = rating), by = .(subjectNumber, ratingCategory, midFile)]

# organise data.table
data_low$subjectNumber <- factor(data_low$subjectNumber)
data_low$Rating <- factor(data_low$rating)
data_low$midFile <- gsub("low_", "", data_low$midFile)

# plot
p_low <- ggplot(data = data_low, aes(x = midFile, y = rating, colour = subjectNumber, group = subjectNumber)) +
  geom_point(aes(shape = subjectNumber), position = position_dodge(width = .5)) +
  facet_wrap((ratingCategory ~ .)) +
  ylim(1, 5)
p_low
```

## Feedback from Anna and Thomas
- If expressions are not matched with notated ones but he likes the expressions, what to rate?
    + Judge to what extent expressions are corresponded with notated ones
- There are many changes in the first system (especially for articulation), it was easy to judge articulation and then focused on dynamics afterwards. When rating, forgot what he thought about articulation.
- Staccato and piano seem to be correlated very much. Could not tell the intention of producing piano. Might be that participants played softly (piano) but just as a result of staccato, for instance.
- The same one for the definition of expressions (should be matched or whether I like them?)
- Definition of staccato. Especially when participants are not implementing articulation, all sounds like staccato or just detached (detachÃ©). she did not know whether participants meant to implement staccato or not. Range of staccato is much smaller than that of legato, so hard to judge. How long should staccato be?
- Range 1-5 is too rough as differences in each performance are so subtle.
- **Several performances have timing issues.**
    + I only looked at 8th not so maybe better to look at 
- Wordings for instructions: to what extent participants follow instructions

## Feedback for my performance
- As I generated stimuli, I am not sure whether my responses are valid because I could mostly categorise stimuli for 4 types even though they were presented randomly (of course some of them, I couldn't).

# Ranking for the generated stimuli
### High performance
- summed the rating for both articulation and dynamics and ranked the performances

### with 3 raters
```{r ranking-high, echo = FALSE}
data_high <- data_high[order(midFile, ratingCategory)]
data_high_sep <- data_high[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_high_both <- data_high[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_high_both[order(-Sum)]
```

### with 2 raters
```{r ranking-high-2, echo = FALSE}
data_high_2 <- data_high[subjectNumber != 3]
data_high_sep_2 <- data_high_2[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_high_both_2 <- data_high_2[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_high_both_2[order(-Sum)]
```

### Articulation performance
- summed the rating for both articulation and dynamics and ranked the performances

### with 3 raters
```{r ranking-art, echo = FALSE}
data_art <- data_art[order(midFile, ratingCategory)]
data_art_sep <- data_art[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_art_both <- data_art[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_art_both[order(-Sum)]
```

### Difference (not sum)
- calculated the difference between the rating for articulation and the rating for dynamics and ranked the performances

```{r ranking-art-diff, echo = FALSE}
# or difference
data_art_diff <- cbind(data_art[ratingCategory == "articulation"], data_art[ratingCategory == "dynamics"])
data_art_diff$Diff <- 0
colnames(data_art_diff)[c(5,11)] <- c("rating1", "rating2")
data_art_diff$Diff <- data_art_diff$rating1 - data_art_diff$rating2
data_art_diff_both <- data_art_diff[, .(N = .N, Diff = sum(Diff)), by = .(midFile)]

data_art_diff_both[order(-Diff)]
```

### with 2 raters
```{r ranking-art-2, echo = FALSE}
data_art_2 <- data_art[subjectNumber != 3]
data_art_sep_2 <- data_art_2[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_art_both_2 <- data_art_2[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_art_both_2[order(-Sum)]
```

### Dynamics performance
- summed the rating for both articulation and dynamics and ranked the performances

### with 3 raters
```{r ranking-dyn, echo = FALSE}
data_dyn <- data_dyn[order(midFile, ratingCategory)]
data_dyn_sep <- data_dyn[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_dyn_both <- data_dyn[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_dyn_both[order(-Sum)]
```

### Difference (not sum)
- calculated the difference between the rating for articulation and the rating for dynamics and ranked the performances

```{r ranking-dyn-diff, echo = FALSE}
# or difference
data_dyn_diff <- cbind(data_dyn[ratingCategory == "dynamics"], data_dyn[ratingCategory == "articulation"])
data_dyn_diff$Diff <- 0
colnames(data_dyn_diff)[c(5,11)] <- c("rating1", "rating2")
data_dyn_diff$Diff <- data_dyn_diff$rating1 - data_dyn_diff$rating2
data_dyn_diff_both <- data_dyn_diff[, .(N = .N, Diff = sum(Diff)), by = .(midFile)]

data_dyn_diff_both[order(-Diff)]
```

### with 2 raters
```{r ranking-dyn-2, echo = FALSE}
data_dyn_2 <- data_dyn[subjectNumber != 3]
data_dyn_sep_2 <- data_dyn_2[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_dyn_both_2 <- data_dyn_2[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_dyn_both_2[order(-Sum)]
```

### Low performance
- summed the rating for both articulation and dynamics and ranked the performances

### with 3 raters
```{r ranking-low, echo = FALSE}
data_low <- data_low[order(midFile, ratingCategory)]
data_low_sep <- data_low[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_low_both <- data_low[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_low_both[order(Sum)]
```

### with 2 raters
```{r ranking-low-2, echo = FALSE}
data_low_2 <- data_low[subjectNumber != 3]
data_low_sep_2 <- data_low_2[, .(N = .N, Sum = sum(rating)), by = .(midFile, ratingCategory)]
data_low_both_2 <- data_low_2[, .(N = .N, Sum = sum(rating)), by = .(midFile)]

data_low_both_2[order(Sum)]
```
