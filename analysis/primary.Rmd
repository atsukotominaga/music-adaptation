---
title: 'Primary analysis'
output:
  html_notebook: default
editor_options: 
  chunk_output_type: inline
---

Description: This is a summary of primary analysis.

- Last checked: `r format(Sys.Date(), "%d-%b-%Y")`

```{r setup, include = FALSE}
# packages
# data manipulation
if (!require("data.table")) {install.packages("data.table"); require("data.table")}
# plot
if (!require("ggpubr")) {install.packages("ggpubr"); require("ggpubr")}
```

```{r file, include = FALSE}
data_ioi = "preprosessor/trimmed/dt_ioi_trimmed.txt"
data_kot = "preprosessor/trimmed/dt_kot_trimmed.txt"
data_vel = "preprosessor/trimmed/dt_vel_trimmed.txt"
data_vel_diff = "preprosessor/trimmed/dt_vel_diff_trimmed.txt"
```

```{r prep, include = FALSE}
dt_ioi <- fread(data_ioi, header = T, sep = ",", dec = ".")
dt_kot <- fread(data_kot, header = T, sep = ",", dec = ".")
dt_vel <- fread(data_vel, header = T, sep = ",", dec = ".")
dt_vel_diff <- fread(data_vel_diff, header = T, sep = ",", dec = ".")

# SubNr as a factor
dt_ioi$SubNr <- as.factor(dt_ioi$SubNr)

# assign stimuli categories
dt_ioi$Stimuli <- as.numeric(gsub(".mid", "", dt_ioi$Stimuli))
dt_ioi$Articulation2 <- "NA"
dt_ioi$Dynamics2 <- "NA"
dt_ioi[Stimuli < 5]$Articulation2 <- "Present"
dt_ioi[Stimuli < 5]$Dynamics2 <- "Absent"
dt_ioi[Stimuli > 4 & Stimuli < 9]$Articulation2 <- "Absent"
dt_ioi[Stimuli > 4 & Stimuli < 9]$Dynamics2 <- "Present"
dt_ioi[Stimuli > 8 & Stimuli < 13]$Articulation2 <- "Present"
dt_ioi[Stimuli > 8 & Stimuli < 13]$Dynamics2 <- "Present"
dt_ioi[Stimuli > 12]$Articulation2 <- "Absent"
dt_ioi[Stimuli > 12]$Dynamics2 <- "Absent"

dt_kot$Stimuli <- as.numeric(gsub(".mid", "", dt_kot$Stimuli))
dt_kot$Articulation2 <- "NA"
dt_kot$Dynamics2 <- "NA"
dt_kot[Stimuli < 5]$Articulation2 <- "Present"
dt_kot[Stimuli < 5]$Dynamics2 <- "Absent"
dt_kot[Stimuli > 4 & Stimuli < 9]$Articulation2 <- "Absent"
dt_kot[Stimuli > 4 & Stimuli < 9]$Dynamics2 <- "Present"
dt_kot[Stimuli > 8 & Stimuli < 13]$Articulation2 <- "Present"
dt_kot[Stimuli > 8 & Stimuli < 13]$Dynamics2 <- "Present"
dt_kot[Stimuli > 12]$Articulation2 <- "Absent"
dt_kot[Stimuli > 12]$Dynamics2 <- "Absent"

dt_vel$Stimuli <- as.numeric(gsub(".mid", "", dt_vel$Stimuli))
dt_vel$Articulation2 <- "NA"
dt_vel$Dynamics2 <- "NA"
dt_vel[Stimuli < 5]$Articulation2 <- "Present"
dt_vel[Stimuli < 5]$Dynamics2 <- "Absent"
dt_vel[Stimuli > 4 & Stimuli < 9]$Articulation2 <- "Absent"
dt_vel[Stimuli > 4 & Stimuli < 9]$Dynamics2 <- "Present"
dt_vel[Stimuli > 8 & Stimuli < 13]$Articulation2 <- "Present"
dt_vel[Stimuli > 8 & Stimuli < 13]$Dynamics2 <- "Present"
dt_vel[Stimuli > 12]$Articulation2 <- "Absent"
dt_vel[Stimuli > 12]$Dynamics2 <- "Absent"

dt_vel_diff$Stimuli <- as.numeric(gsub(".mid", "", dt_vel_diff$Stimuli))
dt_vel_diff$Articulation2 <- "NA"
dt_vel_diff$Dynamics2 <- "NA"
dt_vel_diff[Stimuli < 5]$Articulation2 <- "Present"
dt_vel_diff[Stimuli < 5]$Dynamics2 <- "Absent"
dt_vel_diff[Stimuli > 4 & Stimuli < 9]$Articulation2 <- "Absent"
dt_vel_diff[Stimuli > 4 & Stimuli < 9]$Dynamics2 <- "Present"
dt_vel_diff[Stimuli > 8 & Stimuli < 13]$Articulation2 <- "Present"
dt_vel_diff[Stimuli > 8 & Stimuli < 13]$Dynamics2 <- "Present"
dt_vel_diff[Stimuli > 12]$Articulation2 <- "Absent"
dt_vel_diff[Stimuli > 12]$Dynamics2 <- "Absent"
```

# IOI 
## 1. Individual

```{r ioi, echo = FALSE}
# for each individual
ioi_trial <- dt_ioi[, .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(SubNr, TrialNr, Stimuli, Articulation2, Dynamics2)]

ioi <- ioi_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation2, Dynamics2)]
ioi
```

### Plot
#### Boxplot

```{r ioi-plot, echo = FALSE, fig.width = 4.5}
ggboxplot(ioi_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Stimuli, Articulation2, Dynamics2)], "Articulation2", "Mean", color = "Dynamics2", add = "jitter", facet.by = "SubNr", xlab = "Articulation", ylab = "IOIs (ms)", title = "IOI")
```

## 2. All - group

```{r ioi-all, echo = FALSE}
# group mean
ioi_all <- ioi[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation2, Dynamics2)]
ioi_all
```

### Plot
#### Box plot

```{r ioi-all-plot, echo = FALSE}
ggboxplot(ioi, "Articulation2", "Mean", color = "Dynamics2", add = "jitter", xlab = "Articulation", ylab = "IOIs (ms)", title = "IOI")
```

# Articulation
## 1. Individual
```{r kot, echo = FALSE}
# for each individual
kot_trial <- dt_kot[Articulation == "Legato" | Articulation == "Staccato", .(N = .N, Mean = mean(KOT), SD = sd(KOT)), by = .(SubNr, TrialNr, Stimuli, Articulation2, Dynamics2, Articulation)]

kot <- kot_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation2, Dynamics2, Articulation)]
kot
```

### Plot
#### Boxplot

```{r kot-plot,  echo = FALSE, fig.width = 4.5}
ggboxplot(kot_trial[Articulation == "Legato"], "Articulation2", "Mean", color = "Dynamics2", add = "jitter", facet.by = "SubNr", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Legato)")

ggboxplot(kot_trial[Articulation == "Staccato"], "Articulation2", "Mean", color = "Dynamics2", add = "jitter", facet.by = "SubNr", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Staccato)")
```

## 2. All - group
```{r kot-all, echo = FALSE}
# group mean
kot_all <- kot[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation2, Dynamics2, Articulation)]
kot_all
```

### Plot
#### Boxplot

```{r kot-all-plot, echo = FALSE}
ggboxplot(kot[Articulation == "Legato"], "Articulation2", "Mean", color = "Dynamics2", add = "jitter", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Legato)")

ggboxplot(kot[Articulation == "Staccato"], "Articulation2", "Mean", color = "Dynamics2", add = "jitter", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Staccato)")
```

# Dynamics
## 1. Individual
```{r vel, echo = FALSE}
# for each individual
vel_trial <- dt_vel[Dynamics != "NA", .(N = .N, Mean = mean(Velocity), SD = sd(Velocity)), by = .(SubNr, TrialNr, Stimuli, Articulation2, Dynamics2, Dynamics)]

vel <- vel_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation2, Dynamics2, Dynamics)]
vel
```

### Plot
#### Boxplot

```{r vel-plot, echo = FALSE, fig.width = 4.5}
ggboxplot(vel_trial[Dynamics == "Forte"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", facet.by = "SubNr", xlab = "SubNr", ylab = "Velocity", title = "KV (Forte)")

ggboxplot(vel_trial[Dynamics == "Piano"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", facet.by = "SubNr", xlab = "SubNr", ylab = "Velocity", title = "KV (Piano)")
```

## 2. All - group
```{r vel-all, echo = FALSE}
# group mean
vel_all <- vel[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation2, Dynamics2, Dynamics)]
vel_all
```

### Plot
#### Boxplot

```{r vel-all-plot,  echo = FALSE}
ggboxplot(vel[Dynamics == "Forte"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", xlab = "Dynamics", ylab = "Velocity", title = "KV (Forte)")

ggboxplot(vel[Dynamics == "Piano"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", xlab = "Dynamics", ylab = "Velocity", title = "KV (Piano)")
```

# Dynamics Difference
## 1. Individual
```{r vel-diff, echo = FALSE}
# for each individual
vel_diff_trial <- dt_vel_diff[Dynamics == "FtoP" | Dynamics == "PtoF", .(N = .N, Mean = mean(Diff), SD = sd(Diff)), by = .(SubNr, TrialNr, Stimuli, Articulation2, Dynamics2, Dynamics)]

vel_diff <- vel_diff_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation2, Dynamics2, Dynamics)]
vel_diff
```

### Plot
#### Boxplot

```{r vel-diff-plot, echo = FALSE, fig.width = 4.5}
ggboxplot(vel_diff_trial[Dynamics == "FtoP"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", facet.by = "SubNr", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV-Diff (FtoP)")

ggboxplot(vel_diff_trial[Dynamics == "PtoF"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", facet.by = "SubNr", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV-Diff (PtoF)")
```

## 2. All - group
```{r vel-diff-all, echo = FALSE}
# group mean
vel_diff_all <- vel_diff[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation2, Dynamics2, Dynamics)]
vel_diff_all
```

### Plot
#### Boxplot

```{r vel-diff-all-plot,  echo = FALSE}
ggboxplot(vel_diff[Dynamics == "FtoP"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV (FtoP)")

ggboxplot(vel_diff[Dynamics == "PtoF"], "Dynamics2", "Mean", color = "Articulation2", add = "jitter", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV (PtoF)")
```
