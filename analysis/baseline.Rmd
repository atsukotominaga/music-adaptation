---
title: 'Music adaptation: Analysis'
output:
  html_notebook: default
editor_options: 
  chunk_output_type: inline
---

Description: This is a summary of analysis comparing between baseline and test performance.

- Last checked: `r format(Sys.Date(), "%d-%b-%Y")`

## Experimental Design

- Independent variables: Articulation (2 levels: Present or Absent) x Dynamics (2 levels: Present or Absent)
- Dependent variables: Interonset intervals (IOIs), Key-overlap time (KOT), Key velocity (KV) and KV Difference

1. Main predictions ([preregistration](https://osf.io/qbzwt))
 
- If students performed the piece without articulation (i.e., only dynamics is implemented in the recordings), participants should exaggerate articulation more (i.e., producing longer legato and shorter staccato).
- If students performed the piece without dynamics (i.e., only articulation is implemented in the recordings), participants should exaggerate dynamics more (i.e., producing louder forte and softer piano).
- If students performed the piece without articulation and dynamics (i.e., neither articulation nor dynamics is implemented in the recordings), participants should exaggerate both articulation and dynamics more.

2. Excluded participants

- NA

3. Stats packages

- [afex](https://github.com/singmann/afex) for ANOVAs

```{r setup, include = FALSE}
# set chunk option
knitr::opts_chunk$set(echo = FALSE)

# packages
# data manipulation
if (!require("data.table")) {install.packages("data.table"); require("data.table")}
# stats
if (!require("afex")) {install.packages("afex"); require("afex")}
if (!require("emmeans")) {install.packages("emmeans"); require("emmeans")}
# plot
if (!require("ggpubr")) {install.packages("ggpubr"); require("ggpubr")}
```

```{r file, include = FALSE}
data_ioi = "preprocessor/trimmed/dt_ioi_trimmed.txt"
data_kot = "preprocessor/trimmed/dt_kot_trimmed.txt"
data_vel = "preprocessor/trimmed/dt_vel_trimmed.txt"
data_vel_diff = "preprocessor/trimmed/dt_vel_diff_trimmed.txt"
data_bl_ioi = "preprocessor/predata/trimmed/dt_ioi_trimmed.txt"
data_bl_kot = "preprocessor/predata/trimmed/dt_kot_trimmed.txt"
data_bl_vel = "preprocessor/predata/trimmed/dt_vel_trimmed.txt"
data_bl_vel_diff = "preprocessor/predata/trimmed/dt_vel_diff_trimmed.txt"
```

```{r prep, include = FALSE}
# read data
dt_ioi <- fread(data_ioi, header = T, sep = ",", dec = ".")
dt_kot <- fread(data_kot, header = T, sep = ",", dec = ".")
dt_vel <- fread(data_vel, header = T, sep = ",", dec = ".")
dt_vel_diff <- fread(data_vel_diff, header = T, sep = ",", dec = ".")

dt1.list <- list(dt_ioi, dt_kot, dt_vel, dt_vel_diff) # make a list of data tables

# add labels to data tables
label <- function(data){
  data[, "SubNr" := as.factor(data$SubNr)]
  data[, "Stimuli" := as.numeric(gsub(".mid", "", data$Stimuli))]
  data[, c("Articulation", "Dynamics", "Category") := .("NA", "NA", "NA")]
  data[Stimuli < 5, c("Articulation", "Dynamics", "Category") := .("Present", "Absent", "art_only")]
  data[Stimuli > 4 & Stimuli < 9, c("Articulation", "Dynamics", "Category") := .("Absent", "Present", "dyn_only")]
  data[Stimuli > 8 & Stimuli < 13, c("Articulation", "Dynamics", "Category") := .("Present", "Present", "both")]
  data[Stimuli > 12, c("Articulation", "Dynamics", "Category") := .("Absent", "Absent", "none")]
}

# perform the function above
res <- lapply(dt1.list, label)

# read data (baseline performances)
dt_bl_ioi <- fread(data_bl_ioi, header = T, sep = ",", dec = ".")
dt_bl_kot <- fread(data_bl_kot, header = T, sep = ",", dec = ".")
dt_bl_vel <- fread(data_bl_vel, header = T, sep = ",", dec = ".")
dt_bl_vel_diff <- fread(data_bl_vel_diff, header = T, sep = ",", dec = ".")

dt2.list <- list(dt_bl_ioi, dt_bl_kot, dt_bl_vel, dt_bl_vel_diff) # make a list of data tables (baseline performances)

# add labels to data tables
label_bl <- function(data){
  data[, "SubNr" := as.factor(data$SubNr)]
  data[, c("Articulation", "Dynamics", "Category") := .("Baseline", "Baseline", "baseline")]
}

# perform the function above
res_bl <- lapply(dt2.list, label_bl)

# combine data with baseline performance
dt_ioi <- rbind(dt_ioi, dt_bl_ioi)
dt_kot <- rbind(dt_kot, dt_bl_kot)
dt_vel <- rbind(dt_vel, dt_bl_vel)
dt_vel_diff <- rbind(dt_vel_diff, dt_bl_vel_diff)
```

# IOI 
## 1. Individual

```{r ioi}
# for each individual
dt_ioi$Articulation <- factor(dt_ioi$Articulation, c("Present", "Absent", "Baseline"))
dt_ioi$Dynamics <- factor(dt_ioi$Dynamics, c("Present", "Absent", "Baseline"))

ioi_trial <- dt_ioi[, .(N = .N, Mean = mean(IOI), SD = sd(IOI), CV = sd(IOI)/mean(IOI)), by = .(SubNr, TrialNr, Stimuli, Articulation, Dynamics, Category)]

ioi <- ioi_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), CV = mean(CV)), by = .(SubNr, Articulation, Dynamics, Category)]
setorder(ioi, "SubNr", "Articulation", "Dynamics", "Category")
ioi
```

### Plot
#### Boxplot

```{r ioi-plot, fig.width = 6}
ggboxplot(ioi_trial, "Articulation", "Mean", color = "Dynamics", add = "jitter", facet.by = "SubNr", xlab = "Articulation", ylab = "IOIs (ms)", title = "IOI")
```

## 2. Group

```{r ioi-all}
# group mean
ioi_all <- ioi[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean), CV = mean(CV)), by = .(Articulation, Dynamics, Category)]
ioi_all
```

### Plot
#### Box plot

```{r ioi-all-plot}
ggplot(ioi, aes(x = Articulation, y = Mean, color = Dynamics)) +
  geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) + labs(y = "IOI (ms)", title = "IOI") +
  theme_pubr()
 
#ggboxplot(ioi, "Articulation", "Mean", color = "Dynamics", add = "jitter", xlab = "Articulation", ylab = "IOIs (ms)", title = "IOI")
```

## 3. Sequence plots

```{r seq-ioi, fig.width = 7, fig.height = 2}
ioi_seq <- dt_ioi[, .(N = .N, Mean = mean(IOI), SD = sd(IOI)), by = .(SubNr, Category, Interval)]

ggline(ioi_seq, x = "Interval", y = "Mean", add = "mean_se", position = position_dodge(.2), shape = "Category", color = "Category", xlab = "Interval", ylab = "IOIs (ms)", title = "IOI") + scale_x_continuous(breaks = seq(1,71,1))
```

## 4. Stats

1) Articulation x Dynamics

```{r}
ioi_all_aov <- aov_ez(
  data = ioi[Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics"),
  detailed = TRUE
)

ioi_all_aov$anova_table
pairs(emmeans(ioi_all_aov, ~Dynamics|Articulation), adjust = "tukey")
```

2) Category: All

```{r}
ioi_ca_all_aov <- aov_ez(
  data = ioi,
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

ioi_ca_all_aov$anova_table
pairs(emmeans(ioi_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. none vs. baseline

```{r}
ioi_ca_par_aov <- aov_ez(
  data = ioi[Category == "both" | Category == "none" | Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

ioi_ca_par_aov$anova_table
pairs(emmeans(ioi_ca_par_aov, "Category"), adjust = "tukey")
```

4) Variability

```{r}
var_stats <- aov_ez(
  data = ioi,
  id = "SubNr",
  dv = "SD",
  within = c("Category")
)

var_stats$anova_table
```

# Articulation
## 1. Individual

```{r kot, echo = FALSE}
# for each individual
dt_kot$Articulation <- factor(dt_kot$Articulation, c("Present", "Absent", "Baseline"))
dt_kot$Dynamics <- factor(dt_kot$Dynamics, c("Present", "Absent", "Baseline"))

kot_trial <- dt_kot[Subcomponent1 == "Legato" | Subcomponent1 == "Staccato", .(N = .N, Mean = mean(KOT), SD = sd(KOT)), by = .(SubNr, TrialNr, Stimuli, Articulation, Dynamics, Category, Subcomponent1)]

kot <- kot_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation, Dynamics, Category, Subcomponent1)]
setorder(kot, "SubNr", "Subcomponent1", "Articulation", "Dynamics", "Category")
kot
```

### Plot
#### Boxplot

```{r kot-plot,  echo = FALSE, fig.width = 6}
ggboxplot(kot_trial[Subcomponent1 == "Legato"], "Articulation", "Mean", color = "Dynamics", add = "jitter", facet.by = "SubNr", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Legato)")

ggboxplot(kot_trial[Subcomponent1 == "Staccato"], "Articulation", "Mean", color = "Dynamics", add = "jitter", facet.by = "SubNr", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Staccato)")
```

## 2. Group

```{r kot-all, echo = FALSE}
# group mean
kot_all <- kot[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation, Dynamics, Category, Subcomponent1)]
kot_all
```

### Plot
#### Boxplot

```{r kot-all-plot, echo = FALSE}
ggplot(kot[Subcomponent1 == "Legato"], aes(x = Articulation, y = Mean, color = Dynamics)) +
  geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) +
  labs(y = "KOT (ms)", title = "KOT - Legato") +
  theme_pubr()

ggplot(kot[Subcomponent1 == "Staccato"], aes(x = Articulation, y = Mean, color = Dynamics)) +
  geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) +
  labs(y = "KOT (ms)", title = "KOT - Staccato") +
  theme_pubr()

#ggboxplot(kot[Subcomponent1 == "Legato"], "Articulation", "Mean", color = "Dynamics", add = "jitter", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Legato)")

#ggboxplot(kot[Subcomponent1 == "Staccato"], "Articulation", "Mean", color = "Dynamics", add = "jitter", xlab = "Articulation", ylab = "KOT (ms)", title = "KOT (Staccato)")
```

## 3. Sequence plots

```{r seq-kot, fig.width = 7, fig.height = 2}
kot_seq <- dt_kot[, .(N = .N, Mean = mean(KOT), SD = sd(KOT)), by = .(SubNr, Category, Interval)]

ggline(kot_seq, x = "Interval", y = "Mean", add = "mean_se", position = position_dodge(.2), shape = "Category", color = "Category", xlab = "Interval", ylab = "KOT (ms)", title = "KOT") + scale_x_continuous(breaks = seq(1,71,1))
```

## 4. Stats
### Legato

1) Articulation x Dynamics

```{r}
leg_all_aov <- aov_ez(
  data = kot[Subcomponent1 == "Legato" & Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics")
)

leg_all_aov$anova_table
pairs(emmeans(leg_all_aov, ~Dynamics|Articulation), adjust = "tukey")
```

2) Category: All

```{r}
leg_ca_all_aov <- aov_ez(
  data = kot[Subcomponent1 == "Legato"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)
leg_ca_all_aov

leg_ca_all_aov$anova_table
pairs(emmeans(leg_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. dyn_only vs. baseline

```{r}
leg_ca_par_aov <- aov_ez(
  data = kot[Subcomponent1 == "Legato" & Category == "both" | Subcomponent1 == "Legato" & Category == "dyn_only" | Subcomponent1 == "Legato" & Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)
leg_ca_par_aov

leg_ca_par_aov$anova_table
pairs(emmeans(leg_ca_par_aov, "Category"), adjust = "tukey")
```

### Staccato

1) Articulation x Dynamics

```{r}
sta_all_aov <- aov_ez(
  data = kot[Subcomponent1 == "Staccato" & Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics")
)

sta_all_aov$anova_table
pairs(emmeans(sta_all_aov, ~Dynamics|Articulation), adjust = "tukey")
```

2) Category: All

```{r}
sta_ca_all_aov <- aov_ez(
  data = kot[Subcomponent1 == "Staccato"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

sta_ca_all_aov$anova_table
pairs(emmeans(sta_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. dyn_only vs. baseline

```{r}
sta_ca_par_aov <- aov_ez(
  data = kot[Subcomponent1 == "Staccato" & Category == "both" | Subcomponent1 == "Staccato" & Category == "dyn_only" | Subcomponent1 == "Staccato" & Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

sta_ca_par_aov$anova_table
pairs(emmeans(sta_ca_par_aov, "Category"), adjust = "tukey")
```

# Dynamics
## 1. Individual

```{r vel, echo = FALSE}
# for each individual
dt_vel$Articulation <- factor(dt_vel$Articulation, c("Present", "Absent", "Baseline"))
dt_vel$Dynamics <- factor(dt_vel$Dynamics, c("Present", "Absent", "Baseline"))

vel_trial <- dt_vel[Subcomponent2 != "NA", .(N = .N, Mean = mean(Velocity), SD = sd(Velocity)), by = .(SubNr, TrialNr, Stimuli, Articulation, Dynamics, Category, Subcomponent2)]

vel <- vel_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation, Dynamics, Category, Subcomponent2)]
setorder(vel, "Subcomponent2", "SubNr", "Dynamics", "Articulation", "Category")
vel
```

### Plot
#### Boxplot

```{r vel-plot, echo = FALSE, fig.width = 6}
ggboxplot(vel_trial[Subcomponent2 == "Forte"], "Dynamics", "Mean", color = "Articulation", add = "jitter", facet.by = "SubNr", xlab = "SubNr", ylab = "Velocity", title = "KV (Forte)")

ggboxplot(vel_trial[Subcomponent2 == "Piano"], "Dynamics", "Mean", color = "Articulation", add = "jitter", facet.by = "SubNr", xlab = "SubNr", ylab = "Velocity", title = "KV (Piano)")
```

## 2. Group

```{r vel-all, echo = FALSE}
# group mean
vel_all <- vel[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation, Dynamics, Category, Subcomponent2)]
vel_all
```

### Plot
#### Boxplot

```{r vel-all-plot,  echo = FALSE}
ggplot(vel[Subcomponent2 == "Forte"], aes(x = Dynamics, y = Mean, color = Articulation))+ 
    geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) +
  labs(y = "Key Velocity (0-127)", title = "KV - Forte") +
  theme_pubr()

ggplot(vel[Subcomponent2 == "Piano"], aes(x = Dynamics, y = Mean, color = Articulation))+ 
    geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) +
  labs(y = "Key Velocity (0-127)", title = "KV - Piano") +
  theme_pubr()

#ggboxplot(vel[Subcomponent2 == "Forte"], "Dynamics", "Mean", color = "Articulation", add = "jitter", xlab = "Dynamics", ylab = "Velocity", title = "KV (Forte)")

#ggboxplot(vel[Subcomponent2 == "Piano"], "Dynamics", "Mean", color = "Articulation", add = "jitter", xlab = "Dynamics", ylab = "Velocity", title = "KV (Piano)")
```

## 3. Sequence plots

```{r seq-vel, fig.width = 7, fig.height = 2}
vel_seq <- dt_vel[, .(N = .N, Mean = mean(Velocity), SD = sd(Velocity)), by = .(SubNr, Category, RowNr)]

ggline(vel_seq, x = "RowNr", y = "Mean", add = "mean_se", position = position_dodge(.2), shape = "Category", color = "Category", xlab = "Note Nr", ylab = "Key Velocity (0-127)", title = "KV") + scale_x_continuous(breaks = seq(1,72,1))
```

## 4. Stats
### Forte

1) Articulation x Dynamics

```{r}
for_all_aov <- aov_ez(
  data = vel[Subcomponent2 == "Forte" & Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics")
)

for_all_aov$anova_table
pairs(emmeans(for_all_aov, ~Articulation|Dynamics), adjust = "tukey")
```

2) Category: All

```{r}
for_ca_all_aov <- aov_ez(
  data = vel[Subcomponent2 == "Forte"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

for_ca_all_aov$anova_table
pairs(emmeans(for_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. art_only vs. baseline

```{r}
for_ca_par_aov <- aov_ez(
  data = vel[Subcomponent2 == "Forte" & Category == "both" | Subcomponent2 == "Forte" & Category == "art_only" | Subcomponent2 == "Forte" & Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

for_ca_par_aov$anova_table
pairs(emmeans(for_ca_par_aov, "Category"), adjust = "tukey")
```

### Piano

1) Articulation x Dynamics

```{r}
pia_all_aov <- aov_ez(
  data = vel[Subcomponent2 == "Piano" & Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics")
)

pia_all_aov$anova_table
pairs(emmeans(pia_all_aov, ~Articulation|Dynamics), adjust = "tukey")
```

2) Category: All

```{r}
pia_ca_all_aov <- aov_ez(
  data = vel[Subcomponent2 == "Piano"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

pia_ca_all_aov$anova_table
pairs(emmeans(pia_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. art_only vs. baseline

```{r}
pia_ca_par_aov <- aov_ez(
  data = vel[Subcomponent2 == "Piano" & Category == "both" | Subcomponent2 == "Piano" & Category == "art_only" | Subcomponent2 == "Piano" & Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

pia_ca_par_aov$anova_table
pairs(emmeans(pia_ca_par_aov, "Category"), adjust = "tukey")
```

# Dynamics Difference
## 1. Individual

```{r vel-diff, echo = FALSE}
# for each individual
dt_vel_diff$Articulation <- factor(dt_vel_diff$Articulation, c("Present", "Absent", "Baseline"))
dt_vel_diff$Dynamics <- factor(dt_vel_diff$Dynamics, c("Present", "Absent", "Baseline"))

vel_diff_trial <- dt_vel_diff[Subcomponent2 == "FtoP" | Subcomponent2 == "PtoF", .(N = .N, Mean = mean(Diff), SD = sd(Diff)), by = .(SubNr, TrialNr, Stimuli, Articulation, Dynamics, Category, Subcomponent2)]

vel_diff <- vel_diff_trial[, .(N = .N, Mean = mean(Mean), SD = sd(Mean)), by = .(SubNr, Articulation, Dynamics, Category, Subcomponent2)]
setorder(vel_diff, "SubNr", "Dynamics", "Articulation", "Category")
vel_diff
```

### Plot
#### Boxplot

```{r vel-diff-plot, echo = FALSE, fig.width = 6}
ggboxplot(vel_diff_trial[Subcomponent2 == "FtoP"], "Dynamics", "Mean", color = "Articulation", add = "jitter", facet.by = "SubNr", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV-Diff (FtoP)")

ggboxplot(vel_diff_trial[Subcomponent2 == "PtoF"], "Dynamics", "Mean", color = "Articulation", add = "jitter", facet.by = "SubNr", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV-Diff (PtoF)")
```

## 2. Group

```{r vel-diff-all, echo = FALSE}
# group mean
vel_diff_all <- vel_diff[, .(N = .N, Mean = mean(Mean), SD = sd(Mean), SEM = sd(Mean)/sqrt(.N), Median = median(Mean), IQR = IQR(Mean)), by = .(Articulation, Dynamics, Category, Subcomponent2)]
vel_diff_all
```

### Plot
#### Boxplot

```{r vel-diff-all-plot,  echo = FALSE}
ggplot(vel_diff[Subcomponent2 == "FtoP"], aes(x = Dynamics, y = Mean, color = Articulation))+ 
  geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) +
  labs(y = "KV Difference (-127-127)", title = "KV Difference - Forte to Piano") +
  theme_pubr()

ggplot(vel_diff[Subcomponent2 == "PtoF"], aes(x = Dynamics, y = Mean, color = Articulation))+ 
  geom_boxplot(outlier.shape = NA, position = position_dodge2(preserve = "single")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.25), alpha = 0.5) +
  labs(y = "KV Difference (-127-127)", title = "KV Difference - Piano to Forte") +
  theme_pubr()

#ggboxplot(vel_diff[Subcomponent2 == "FtoP"], "Dynamics", "Mean", color = "Articulation", add = "jitter", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV (FtoP)")

#ggboxplot(vel_diff[Subcomponent2 == "PtoF"], "Dynamics", "Mean", color = "Articulation", add = "jitter", xlab = "Dynamics", ylab = "Velocity Difference", title = "KV (PtoF)")
```

## 3. Sequence plots

```{r seq-vel-diff, fig.width = 7, fig.height = 2}
vel_diff_seq <- dt_vel_diff[, .(N = .N, Mean = mean(Diff), SD = sd(Diff)), by = .(SubNr, Category, Interval)]

ggline(vel_diff_seq, x = "Interval", y = "Mean", add = "mean_se", position = position_dodge(.2), shape = "Category", color = "Category", xlab = "Interval", ylab = "Difference", title = "Velocity Difference") + scale_x_continuous(breaks = seq(1,71,1))
```

## 4. Stats
### FtoP

1) Articulation x Dynamics

```{r}
ftop_all_aov <- aov_ez(
  data = vel_diff[Subcomponent2 == "FtoP" & Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics")
)

ftop_all_aov$anova_table
pairs(emmeans(ftop_all_aov, ~Articulation|Dynamics), adjust = "tukey")
```

2) Category: All

```{r}
ftop_ca_all_aov <- aov_ez(
  data = vel_diff[Subcomponent2 == "FtoP"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

ftop_ca_all_aov$anova_table
pairs(emmeans(ftop_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. art_only vs. baseline

```{r}
ftop_ca_par_aov <- aov_ez(
  data = vel_diff[Subcomponent2 == "FtoP" & Category == "both" | Subcomponent2 == "FtoP" & Category == "art_only" | Subcomponent2 == "FtoP" & Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

ftop_ca_par_aov$anova_table
pairs(emmeans(ftop_ca_par_aov, "Category"), adjust = "tukey")
```

### PtoF

1) Articulation x Dynamics

```{r}
ptof_all_aov <- aov_ez(
  data = vel_diff[Subcomponent2 == "PtoF" & Category != "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Articulation", "Dynamics")
)

ptof_all_aov$anova_table
pairs(emmeans(ptof_all_aov, ~Articulation|Dynamics), adjust = "tukey")
```

2) Category: All

```{r}
ptof_ca_all_aov <- aov_ez(
  data = vel_diff[Subcomponent2 == "PtoF"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

ptof_ca_all_aov$anova_table
pairs(emmeans(ptof_ca_all_aov, "Category"), adjust = "tukey")
```

3) Category: both vs. art_only vs. baseline

```{r}
ptof_ca_par_aov <- aov_ez(
  data = vel_diff[Subcomponent2 == "PtoF" & Category == "both" | Subcomponent2 == "PtoF" & Category == "art_only" | Subcomponent2 == "FtoP" & Category == "baseline"],
  id = "SubNr",
  dv = "Mean",
  within = c("Category")
)

ptof_ca_par_aov
pairs(emmeans(ftop_ca_par_aov, "Category"), adjust = "tukey")
```
